(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
//Redirection de page
function connectPage(){
    window.location.href = "connectPage.html";   
}
function homePage(){
    window.location.href = "index.html";
}

function displayForm(element){
    form = element.nextElementSibling
    if (form.style.display === "none") {
        form.style.display = "block";
    } else {
        form.style.display = "none";
    }
}
window.addEventListener("load", () => {
    loginStatu();
  });
async function loginStatu(){
    let statu = document.getElementById("statuLog");
    user = await check_connect();   
   
    if(user.id === undefined){
        statu.innerHTML = "login";
        statu.addEventListener("click", (event) => {
            event.preventDefault();
            window.location.href = "connectPage.html";
        });
    }
    else{
        statu.innerHTML = "Deconnexion";
        statu.addEventListener("click", (event) => {
            let  id = user.id;
            event.preventDefault();
            deconnexion(id);
            statu.innerHTML = "login";
     });
    }
}
async function deconnexion(id) {
    try {
        let response = await fetch(`http://localhost:8000/api/disconnect/${id}`,{
            method: "PATCH"
        });
        let data = await response.json();
        if (data === null) {
            return true;
        } 
        else {
            return false;
        }
    } 
    catch (error) {
        console.error('Error:', error);        
        return false; 
    }
}

async function check_connect() {
    try {
        const response = await fetch("http://localhost:8000/api/get_connexion", {
            method: "GET"
        });
        const data = await response.json();
        console.log(data);
        return data;
    } catch (error) {
        throw error;
    }
}
},{}]},{},[1]);
